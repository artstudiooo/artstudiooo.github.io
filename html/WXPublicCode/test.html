<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>消息推送</title>
    <script src="https://more.artstudiooo.com/lib/axios.min.js"></script>
    <link rel="stylesheet" href="https://more.artstudiooo.com/lib/bootstrap.min.css">
</head>

<body class="d-flex justify-content-center align-items-center" style="
    width: 100%;
    background-image: url('https://www.artstudiooo.com/wxpublic/bg.jpg');
    background-size: 100% 100%;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
">

<div class="m-5 overflow-auto" style="width: 800px;background-color: rgba(255,255,255,0.3);border-radius: 25px">
    <div class="text-center pt-3">
        <h1 class="font-weight-bold">首先，关注我们的公众号，发送”<span class="text-danger">教程</span>“。</h1>
        <h1 class="font-weight-bold">( 制作不易，感谢理解 )</h1>
    </div>
    <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
        <img src="https://www.artstudiooo.com/wxpublic/wx.jpg" height="200px" style="border: 3px solid black">
    </div>

    <div class="text-center pt-3">
        <h1 class="font-weight-bold">然后，填写上您的主要信息。</h1>
    </div>
    <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
        <div class="form-group w-50">
            <label for="appID">请输入您的 appID：</label><input class="form-control text-center" type="text" name="appID" id="appID">
        </div>
        <div class="form-group w-50">
            <label for="appsecret">输入您的 appsecret：</label><input class="form-control text-center" type="text" name="appsecret" id="appsecret">
        </div>
        <div class="form-group w-50">
            <label for="templateID">输入您的 模板ID：</label><input class="form-control text-center" type="text" name="templateID" id="templateID">
        </div>
        <div class="form-group w-50">
            <label for="openID">输入您用户列表中需要发送的 微信号：</label><input class="form-control text-center" type="text" name="openID" id="openID">
        </div>
    </div>

    <div class="text-center pt-3">
        <h1 class="font-weight-bold">最后，填上您想发送的消息。</h1>
    </div>
    <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
        <div class="form-group w-50">
            <label for="key1">输入您需要发送的内容1</label><input class="form-control text-center" type="text" name="key1" id="key1">
        </div>
        <div class="form-group w-50">
            <label for="key2">输入您需要发送的内容2</label><input class="form-control text-center" type="text" name="key2" id="key2">
        </div>
        <div class="form-group w-50">
            <label for="key3">输入您需要发送的内容3</label><input class="form-control text-center" type="text" name="key3" id="key3">
        </div>
        <div class="form-group w-50">
            <label for="key4">输入您需要发送的内容4</label><input class="form-control text-center" type="text" name="key4" id="key4">
        </div>
        <div class="form-group w-50">
            <label for="key5">输入您需要发送的内容5</label><input class="form-control text-center" type="text" name="key5" id="key5">
        </div>
        <div class="form-group w-50">
            <label for="key6">输入您需要发送的内容6</label><input class="form-control text-center" type="text" name="key6" id="key6">
        </div>
        <div class="form-group w-50">
            <label for="key7">输入您需要发送的内容7</label><input class="form-control text-center" type="text" name="key7" id="key7">
        </div>
        <div class="form-group w-50">
            <label for="key8">输入您需要发送的内容8</label><input class="form-control text-center" type="text" name="key8" id="key8">
        </div>
        <div class="form-group w-50">
            <label for="key9">输入您需要发送的内容9</label><input class="form-control text-center" type="text" name="key9" id="key9">
        </div>
        <div class="form-group w-50">
            <label for="key10">输入您需要发送的内容10</label><input class="form-control text-center" type="text" name="key10" id="key10">
        </div>
        <div class="form-group w-50">
            <label for="key11">输入您需要发送的内容11</label><input class="form-control text-center" type="text" name="key11" id="key11">
        </div>
        <div class="form-group w-50">
            <label for="key12">输入您需要发送的内容12</label><input class="form-control text-center" type="text" name="key12" id="key12">
        </div>
        <div class="form-group w-50">
            <label for="key13">输入您需要发送的内容13</label><input class="form-control text-center" type="text" name="key13" id="key13">
        </div>
        <div class="form-group w-50">
            <label for="key13">输入您需要发送的内容14</label><input class="form-control text-center" type="text" name="key14" id="key14">
        </div>
        <div class="form-group w-50">
            <label for="key13">输入您需要发送的内容15</label><input class="form-control text-center" type="text" name="key15" id="key15">
        </div>
    </div>

    <div class="text-center pt-3 pb-3">
        <h2 class="font-weight-bold" id="s1"></h2>
        <h2 class="font-weight-bold" id="s2"></h2>
    </div>
    <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
        <button class="mb-5 w-50 text-danger btn bg-light border-danger" type="button" id="b">发送</button>
    </div>
</div>

<!--    <label for="appID">输入您的 appID：</label><input type="text" name="appID" id="appID">-->
<!--    <label for="appsecret">输入您的 appsecret：</label><input type="text" name="appsecret" id="appsecret">-->
<!--    <label for="templateID">输入您的 模板ID：</label><input style="width: 500px" type="text" name="templateID" id="templateID">-->
<!--    <label for="openID">输入您用户列表中需要发送的 微信号：</label><input type="text" name="openID" id="openID">-->

<!--    <label for="key1">输入您需要发送的内容1：</label><input type="text" name="key1" id="key1">-->
<!--    <label for="key2">输入您需要发送的内容2：</label><input type="text" name="key2" id="key2">-->
<!--    <label for="key3">输入您需要发送的内容3：</label><input type="text" name="key3" id="key3">-->
<!--    <label for="key4">输入您需要发送的内容4：</label><input type="text" name="key4" id="key4">-->
<!--    <label for="key5">输入您需要发送的内容5：</label><input type="text" name="key5" id="key5">-->
<!--    <label for="key6">输入您需要发送的内容6：</label><input type="text" name="key6" id="key6">-->
<!--    <label for="key7">输入您需要发送的内容7：</label><input type="text" name="key7" id="key7">-->
<!--    <label for="key8">输入您需要发送的内容8：</label><input type="text" name="key8" id="key8">-->
<!--    <br />-->
<!--    <br />-->
<!--    <button class="btn btn-outline-dark" type="button" id="b">发送</button>-->
<!--    <p>制作不易，使用教程请关注公众号回复 ”<span class="text-danger">教程</span>“</p>-->
<!--    <img src="https://www.artstudiooo.com/wxpublic/wx.jpg" height="200px" style="border: 3px solid black">-->

</body>
</html>
<script>
    const sentences = [['希望你们，绝不冷战，轮流道歉，不提分手，','有一天互相挽着手，去敬各位来宾的酒。'],['愿天下有情人终成眷属，','前生注定，喜结良缘。'],['愿你们用爱去绾着对方，彼此互相体谅和关怀，','共同分享今后的苦与乐，敬祝百年好合永结同心。'],['由相知而相爱，由相爱而更加相知，','人们常说的神仙眷侣就是你们了。'],['愿你们恩恩爱爱，意笃情深，','此生爱情永恒，爱心与日俱增。']]
    let r = Math.floor(Math.random() * sentences.length)
    document.getElementById('s1').innerText = sentences[r][0]
    document.getElementById('s2').innerText = sentences[r][1]
    let color = ['#40D4F9','#E66E6E','#6EE2E6','#6EE66E','#E2E66E','#E6A26E','#E66E6E','#E66E6E','#E26EE6','#BA6EE6','#6E6EE6','#6EBAE6','#6C7A81','#000000']


    document.getElementById('b').onclick = ()=>{

        let appID = document.getElementById('appID').value.trim()
        let appsecret = document.getElementById('appsecret').value.trim()

        if(!appID || !appsecret || !document.getElementById('key1').value.trim() || !document.getElementById('openID').value.trim() || !document.getElementById('templateID').value.trim()){
            alert("有内容未输入，请检查")
            return
        }

        let token = null


        axios('/tg?appID='+appID+'&appsecret='+appsecret).then(res => {
            token = res.data
            permission()
            alert("发送成功（如果没有收到请更换浏览器或关闭广告拦截功能）")
        });

        const permission = ()=>{
            axios({
                method:"POST",
                url:'https://api.weixin.qq.com/cgi-bin/message/template/send?access_token='+token,
                data:JSON.stringify({
                    "touser": document.getElementById('openID').value.trim(),
                    "template_id": document.getElementById('templateID').value.trim(),
                    "url": "https://www.artstudiooo.com",
                    "data": {
                        "1": {
                            "value": document.getElementById('key1').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "2": {
                            "value": document.getElementById('key2').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "3": {
                            "value": document.getElementById('key3').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "4": {
                            "value": document.getElementById('key4').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "5": {
                            "value": document.getElementById('key5').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "6": {
                            "value": document.getElementById('key6').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "7": {
                            "value": document.getElementById('key7').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "8": {
                            "value": document.getElementById('key8').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "9": {
                            "value": document.getElementById('key9').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "10": {
                            "value": document.getElementById('key10').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "11": {
                            "value": document.getElementById('key11').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "12": {
                            "value": document.getElementById('key12').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "13": {
                            "value": document.getElementById('key13').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "14": {
                            "value": document.getElementById('key14').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                        "15": {
                            "value": document.getElementById('key15').value.trim(),
                            "color": color[Math.floor(Math.random()*15)]
                        },
                    }
                }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'//跨域
                }
            })
        }

    }

    document.onkeydown = function () {
        var e = window.event || arguments[0];
        if (e.keyCode == 123) {
            alert('请尊重劳动成果！');
            return false;
        } else if ((e.ctrlKey) && (e.shiftKey) && (e.keyCode == 73)) {
            alert('请尊重劳动成果！');
            return false;
        } else if ((e.ctrlKey) && (e.keyCode == 85)) {
            alert('请尊重劳动成果！');
            return false;
        } else if ((e.ctrlKey) && (e.keyCode == 83)) {
            alert('请尊重劳动成果！');
            return false;
        }
    }
    document.oncontextmenu = function () {
        alert('请尊重劳动成果！');
        return false;
    }
</script>