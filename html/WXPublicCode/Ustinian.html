<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>消息推送</title>
  <script src="https://more.artstudiooo.com/lib/axios.min.js"></script>
  <link rel="stylesheet" href="https://more.artstudiooo.com/lib/bootstrap.min.css">
</head>

<body class="d-flex justify-content-center align-items-center" style="
    width: 100%;
    background-image: url('https://www.artstudiooo.com/wxpublic/bg.jpg');
    background-size: 100% 100%;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
">

<div class="m-5 overflow-auto" style="width: 800px;background-color: rgba(255,255,255,0.3);border-radius: 25px">
  <div class="d-none">
    <div class="form-group w-50">
      <label for="appID">请输入您的 appID：</label><input class="form-control text-center" type="text" name="appID" id="appID"
                                                    value="wx1be25f7da3bcde31"
    >
    </div>
    <div class="form-group w-50">
      <label for="appsecret">输入您的 appsecret：</label><input class="form-control text-center" type="text" name="appsecret" id="appsecret"
                                                           value="7dc56a5f7ce521519515775ab521b497"
    >
    </div>
    <div class="form-group w-50">
      <label for="templateID">输入您的 模板ID：</label><input class="form-control text-center" type="text" name="templateID" id="templateID"
                                                       value="Z-sL2GC6dviOPG6fv21nF4yR6G48Et3YjJO5ylYgFxo"
    >
    </div>
    <div class="form-group w-50">
      <label for="openID">输入您用户列表中需要发送的 微信号：</label><input class="form-control text-center" type="text" name="openID" id="openID"
                                                           value="oHU1g5zZCPwlJ06R93gLvJecputM"
    >
    </div>
  </div>

  <div class="text-center p-3">
    <h1 class="font-weight-bold" style="letter-spacing: 2px">我们已经注入了您的模板及信息，<br>因此现在只需填上您想发送的消息。</h1>
  </div>
  <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
    <div class="form-group w-50">
      <label for="key1">输入您需要发送的内容1</label><input class="form-control text-center" type="text" name="key1" id="key1">
    </div>
    <div class="form-group w-50">
      <label for="key2">输入您需要发送的内容2</label><input class="form-control text-center" type="text" name="key2" id="key2">
    </div>
    <div class="form-group w-50">
      <label for="key3">输入您需要发送的内容3</label><input class="form-control text-center" type="text" name="key3" id="key3">
    </div>
    <div class="form-group w-50">
      <label for="key4">输入您需要发送的内容4</label><input class="form-control text-center" type="text" name="key4" id="key4">
    </div>
    <div class="form-group w-50">
      <label for="key5">输入您需要发送的内容5</label><input class="form-control text-center" type="text" name="key5" id="key5">
    </div>
    <div class="form-group w-50">
      <label for="key6">输入您需要发送的内容6</label><input class="form-control text-center" type="text" name="key6" id="key6">
    </div>
    <div class="form-group w-50">
      <label for="key7">输入您需要发送的内容7</label><input class="form-control text-center" type="text" name="key7" id="key7">
    </div>
    <div class="form-group w-50">
      <label for="key8">输入您需要发送的内容8</label><input class="form-control text-center" type="text" name="key8" id="key8">
    </div>
    <div class="form-group w-50">
      <label for="key9">输入您需要发送的内容9</label><input class="form-control text-center" type="text" name="key9" id="key9">
    </div>
    <div class="form-group w-50">
      <label for="key10">输入您需要发送的内容10</label><input class="form-control text-center" type="text" name="key10" id="key10">
    </div>
    <div class="form-group w-50">
      <label for="key11">输入您需要发送的内容11</label><input class="form-control text-center" type="text" name="key11" id="key11">
    </div>
    <div class="form-group w-50">
      <label for="key12">输入您需要发送的内容12</label><input class="form-control text-center" type="text" name="key12" id="key12">
    </div>
    <div class="form-group w-50">
      <label for="key13">输入您需要发送的内容13</label><input class="form-control text-center" type="text" name="key13" id="key13">
    </div>
    <div class="form-group w-50">
      <label for="key13">输入您需要发送的内容14</label><input class="form-control text-center" type="text" name="key14" id="key14">
    </div>
    <div class="form-group w-50">
      <label for="key13">输入您需要发送的内容15</label><input class="form-control text-center" type="text" name="key15" id="key15">
    </div>
  </div>

  <div class="text-center pt-3 pb-3">
    <h2 class="font-weight-bold" id="s1"></h2>
    <h2 class="font-weight-bold" id="s2"></h2>
  </div>
  <div class="d-flex flex-column text-center justify-content-center align-items-center text-white m-3">
    <button class="mb-5 w-50 text-danger btn bg-light border-danger" type="button" id="b">发送</button>
  </div>
</div>

<!--    <label for="appID">输入您的 appID：</label><input type="text" name="appID" id="appID">-->
<!--    <label for="appsecret">输入您的 appsecret：</label><input type="text" name="appsecret" id="appsecret">-->
<!--    <label for="templateID">输入您的 模板ID：</label><input style="width: 500px" type="text" name="templateID" id="templateID">-->
<!--    <label for="openID">输入您用户列表中需要发送的 微信号：</label><input type="text" name="openID" id="openID">-->

<!--    <label for="key1">输入您需要发送的内容1：</label><input type="text" name="key1" id="key1">-->
<!--    <label for="key2">输入您需要发送的内容2：</label><input type="text" name="key2" id="key2">-->
<!--    <label for="key3">输入您需要发送的内容3：</label><input type="text" name="key3" id="key3">-->
<!--    <label for="key4">输入您需要发送的内容4：</label><input type="text" name="key4" id="key4">-->
<!--    <label for="key5">输入您需要发送的内容5：</label><input type="text" name="key5" id="key5">-->
<!--    <label for="key6">输入您需要发送的内容6：</label><input type="text" name="key6" id="key6">-->
<!--    <label for="key7">输入您需要发送的内容7：</label><input type="text" name="key7" id="key7">-->
<!--    <label for="key8">输入您需要发送的内容8：</label><input type="text" name="key8" id="key8">-->
<!--    <br />-->
<!--    <br />-->
<!--    <button class="btn btn-outline-dark" type="button" id="b">发送</button>-->
<!--    <p>制作不易，使用教程请关注公众号回复 ”<span class="text-danger">教程</span>“</p>-->
<!--    <img src="https://www.artstudiooo.com/wxpublic/wx.jpg" height="200px" style="border: 3px solid black">-->

</body>
</html>
<script>
  const sentences = [['希望你们，绝不冷战，轮流道歉，不提分手，','有一天互相挽着手，去敬各位来宾的酒。'],['愿天下有情人终成眷属，','前生注定，喜结良缘。'],['愿你们用爱去绾着对方，彼此互相体谅和关怀，','共同分享今后的苦与乐，敬祝百年好合永结同心。'],['由相知而相爱，由相爱而更加相知，','人们常说的神仙眷侣就是你们了。'],['愿你们恩恩爱爱，意笃情深，','此生爱情永恒，爱心与日俱增。']]
  let r = Math.floor(Math.random() * sentences.length)
  document.getElementById('s1').innerText = sentences[r][0]
  document.getElementById('s2').innerText = sentences[r][1]
  let color = ['#40D4F9','#E66E6E','#6EE2E6','#6EE66E','#E2E66E','#E6A26E','#E66E6E','#E66E6E','#E26EE6','#BA6EE6','#6E6EE6','#6EBAE6','#6C7A81','#000000']


  document.getElementById('b').onclick = ()=>{

    let appID = document.getElementById('appID').value.trim()
    let appsecret = document.getElementById('appsecret').value.trim()

    let tempMax = null;
    let tempMin = null;
    let textDay = null;
    let textNight = null;
    let windDirDay = null;
    let windDirNight = null;

    let feelsLike = null;
    let text = null;
    let windDir = null;

    let sen = null;

    if(!document.getElementById('key1').value.trim()){
      alert("有内容未输入，请检查")
      return
    }
    let token = null

    axios('/tg?appID='+appID+'&appsecret='+appsecret).then(res => {
      token = res.data
      getFirstWeather()
    });


    //获取天气 -- 微信号：Ustinian---qq
    const getFirstWeather = ()=>{
      axios("https://devapi.qweather.com/v7/weather/3d?key=9041f443b8194a79848c259895a4d54e&location=101250101").then(res => {
        tempMax = (res.data.daily[0].tempMax)
        tempMin = (res.data.daily[0].tempMin)
        textDay = (res.data.daily[0].textDay)
        textNight = (res.data.daily[0].textNight)
        windDirDay = (res.data.daily[0].windDirDay)
        windDirNight = (res.data.daily[0].windDirNight)
        getSecondWeather()
      });
    }

    const getSecondWeather = ()=>{
      axios("https://devapi.qweather.com/v7/weather/now?key=9041f443b8194a79848c259895a4d54e&location=101250101").then(res => {
        feelsLike = (res.data.now.feelsLike)
        text = (res.data.now.text)
        windDir = (res.data.now.windDir)
        getRainbowSentences()
      });
    }

    const getRainbowSentences = ()=>{
      axios("https://api.shadiao.pro/chp").then(res => {
        sen = (res.data.data.text)
        permission()
      });
    }

    const permission = ()=>{
      axios({
        method:"POST",
        url:'https://api.weixin.qq.com/cgi-bin/message/template/send?access_token='+token,
        data:JSON.stringify({
          "touser": document.getElementById('openID').value.trim(),
          "template_id": document.getElementById('templateID').value.trim(),
          "url": "https://www.artstudiooo.com",
          "data": {
            "1": {
              "value": document.getElementById('key1').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "2": {
              "value": document.getElementById('key2').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "3": {
              "value": document.getElementById('key3').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "4": {
              "value": document.getElementById('key4').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "5": {
              "value": document.getElementById('key5').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "6": {
              "value": document.getElementById('key6').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "7": {
              "value": document.getElementById('key7').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "8": {
              "value": document.getElementById('key8').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "9": {
              "value": document.getElementById('key9').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "10": {
              "value": document.getElementById('key10').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "11": {
              "value": document.getElementById('key11').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "12": {
              "value": document.getElementById('key12').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "13": {
              "value": document.getElementById('key13').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "14": {
              "value": document.getElementById('key14').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "15": {
              "value": document.getElementById('key15').value.trim(),
              "color": color[Math.floor(Math.random()*15)]
            },
            "最高温": {
              "value": tempMax,
              "color": color[Math.floor(Math.random()*15)]
            },
            "最低温": {
              "value": tempMin,
              "color": color[Math.floor(Math.random()*15)]
            },
            "早间天气": {
              "value": textDay,
              "color": color[Math.floor(Math.random()*15)]
            },
            "晚间天气": {
              "value": textNight,
              "color": color[Math.floor(Math.random()*15)]
            },
            "早间风向": {
              "value": windDirDay,
              "color": color[Math.floor(Math.random()*15)]
            },
            "晚间风向": {
              "value": windDirNight,
              "color": color[Math.floor(Math.random()*15)]
            },
            "当前温度": {
              "value": feelsLike,
              "color": color[Math.floor(Math.random()*15)]
            },
            "当前天气": {
              "value": text,
              "color": color[Math.floor(Math.random()*15)]
            },
            "当前风向": {
              "value": windDir,
              "color": color[Math.floor(Math.random()*15)]
            },
            "彩虹屁": {
              "value": sen,
              "color": color[Math.floor(Math.random()*15)]
            },
          }
        }),
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }
      })
    }

    alert("发送成功（如果没有收到请更换浏览器或关闭广告拦截功能）")

  }
</script>
<!--

{{最高温.DATA}}
{{最低温.DATA}}
{{早间天气.DATA}}
{{晚间天气.DATA}}
{{早间风向.DATA}}
{{晚间风向.DATA}}
{{当前温度.DATA}}
{{当前天气.DATA}}
{{当前风向.DATA}}

-->